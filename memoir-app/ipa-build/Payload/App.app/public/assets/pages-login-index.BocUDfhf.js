import{c as e,w as s,s as o,n as a,r as t,u as r,q as i,i as l,o as n,a as d,e as c,d as u,B as f,I as p,m as g,t as h,h as m}from"./index-DQU_JAH0.js";import{a as w}from"./apiConfig.BpiTqs15.js";import{_}from"./_plugin-vue_export-helper.BCo6x5W8.js";const k=_({data:()=>({loginForm:{identifier:"",password:""},errors:{},isLoading:!1}),mounted(){this.errors={}},methods:{updateIdentifier(e){this.loginForm.identifier=e.detail.value||e.target.value||"",this.errors.identifier=""},updatePassword(e){this.loginForm.password=e.detail.value||e.target.value||"",this.errors.password=""},validateForm(){return this.errors={},this.loginForm.identifier.trim()||(this.errors.identifier="è¯·è¾“å…¥ç”¨æˆ·åæˆ–é‚®ç®±"),this.loginForm.password.trim()||(this.errors.password="è¯·è¾“å…¥å¯†ç "),0===Object.keys(this.errors).length},async handleLogin(){if(this.validateForm()){this.isLoading=!0;try{const e=w("/auth/login");console.log("ğŸ” [Login] å‡†å¤‡å‘é€ç™»å½•è¯·æ±‚..."),console.log("ğŸŒ [Login] è¯·æ±‚ URL:",e),console.log("ğŸ“± [Login] å½“å‰ç¯å¢ƒæ£€æµ‹:",{isCapacitor:!!window.Capacitor,userAgent:navigator.userAgent,location:window.location.href});const s=await t({url:e,method:"POST",header:{"Content-Type":"application/json"},data:{identifier:this.loginForm.identifier.trim(),password:this.loginForm.password}});console.log("ç™»å½•å“åº”:",s);const a=s.data;if(200!==s.statusCode&&201!==s.statusCode)throw 400===s.statusCode||401===s.statusCode?new Error(a.message||"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"):new Error("ç½‘ç»œè¯·æ±‚å¤±è´¥");if(!a.success)throw new Error(a.message||"ç™»å½•å¤±è´¥");r("token",a.data.token),r("user",a.data.user),i({title:"ç™»å½•æˆåŠŸ",icon:"success"}),setTimeout(()=>{o({url:"/pages/profile/index"})},1500)}catch(e){console.error("ç™»å½•å¤±è´¥:",e),i({title:e.message||"ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•",icon:"none",duration:2e3})}finally{this.isLoading=!1}}},goToRegister(){a({url:"/pages/register/index"})},goBack(){o({url:"/pages/profile/index"})}}},[["render",function(o,a,t,r,i,w){const _=c,k=l,C=p,v=m;return n(),e(k,{class:"container"},{default:s(()=>[d(k,{class:"back-btn",onClick:w.goBack},{default:s(()=>[d(_,{class:"back-icon"},{default:s(()=>[u("â†")]),_:1})]),_:1},8,["onClick"]),d(k,{class:"login-header"},{default:s(()=>[d(k,{class:"app-title"},{default:s(()=>[u("å²æœˆé•œåƒ")]),_:1}),d(k,{class:"app-subtitle"},{default:s(()=>[u("è®°å½•ç”Ÿå‘½ä¸­çš„æ¯ä¸€ä¸ªçè´µç¬é—´")]),_:1})]),_:1}),d(k,{class:"login-form"},{default:s(()=>[d(k,{class:"form-title"},{default:s(()=>[u("æ¬¢è¿å›æ¥")]),_:1}),d(k,{class:"input-group"},{default:s(()=>[d(k,{class:"input-container"},{default:s(()=>[d(C,{class:g(["input-field",{error:i.errors.identifier}]),type:"text",placeholder:"è¯·è¾“å…¥ç”¨æˆ·åæˆ–é‚®ç®±",value:i.loginForm.identifier,onInput:w.updateIdentifier,autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},null,8,["value","onInput","class"])]),_:1}),i.errors.identifier?(n(),e(_,{key:0,class:"error-text"},{default:s(()=>[u(h(i.errors.identifier),1)]),_:1})):f("",!0)]),_:1}),d(k,{class:"input-group"},{default:s(()=>[d(k,{class:"input-container"},{default:s(()=>[d(C,{class:g(["input-field",{error:i.errors.password}]),type:"password",placeholder:"è¯·è¾“å…¥å¯†ç ",value:i.loginForm.password,onInput:w.updatePassword,autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},null,8,["value","onInput","class"])]),_:1}),i.errors.password?(n(),e(_,{key:0,class:"error-text"},{default:s(()=>[u(h(i.errors.password),1)]),_:1})):f("",!0)]),_:1}),d(k,{class:"btn-container"},{default:s(()=>[d(v,{class:"login-btn",onClick:w.handleLogin,disabled:i.isLoading},{default:s(()=>[u(h(i.isLoading?"ç™»å½•ä¸­...":"ç™»å½•"),1)]),_:1},8,["onClick","disabled"])]),_:1}),d(k,{class:"form-footer"},{default:s(()=>[d(_,{class:"register-text"},{default:s(()=>[u("è¿˜æ²¡æœ‰è´¦å·ï¼Ÿ")]),_:1}),d(_,{class:"register-link",onClick:w.goToRegister},{default:s(()=>[u("ç«‹å³æ³¨å†Œ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})}],["__scopeId","data-v-d60c96f5"]]);export{k as default};
