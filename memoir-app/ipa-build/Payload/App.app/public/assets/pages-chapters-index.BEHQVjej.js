function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/components-LazyImage.DWWZVpe-.js","assets/index-DQU_JAH0.js","assets/index-DBRlL7wL.css","assets/imageMapping.mDgfjL7P.js","assets/_plugin-vue_export-helper.BCo6x5W8.js","assets/LazyImage-4nOqDq01.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{_ as e,c as t,w as a,g as s,r as c,n as o,D as l,i as r,o as d,a as i,e as n,d as p,t as m,S as g,k as h,F as u,l as f,m as _,b,B as I}from"./index-DQU_JAH0.js";import{a as k}from"./apiConfig.BpiTqs15.js";import{i as C}from"./imagePreloader.BIvFExa3.js";import{g as y}from"./imageMapping.mDgfjL7P.js";import{_ as v}from"./_plugin-vue_export-helper.BCo6x5W8.js";const j=v({components:{LazyImage:()=>e(()=>import("./components-LazyImage.DWWZVpe-.js"),__vite__mapDeps([0,1,2,3,4,5]))},data:()=>({chapters:[{id:"background",title:"家庭背景",description:"记录您的出生地、家庭环境和祖辈故事",backgroundImage:"/src/images/story1.png",completed:!1},{id:"childhood",title:"童年时光",description:"分享童年的美好回忆和成长经历",backgroundImage:"/src/images/story2.png",completed:!1},{id:"education",title:"求学生涯",description:"记录学习历程和校园生活",backgroundImage:"/src/images/story3.png",completed:!1},{id:"career",title:"职业发展",description:"分享工作经历和职业成就",backgroundImage:"/src/images/story4.png",completed:!1},{id:"love",title:"爱情婚姻",description:"记录爱情故事和婚姻生活",backgroundImage:"/src/images/story5.png",completed:!1},{id:"family",title:"为人父母",description:"分享育儿经历和家庭生活",backgroundImage:"/src/images/story6.png",completed:!1},{id:"travel",title:"旅行见闻",description:"记录旅行经历和见闻感悟",backgroundImage:"/src/images/story7.png",completed:!1},{id:"relationships",title:"人缘际遇",description:"记录重要的人际关系和人生际遇",backgroundImage:"/src/images/story8.png",completed:!1},{id:"laterlife",title:"晚年生活",description:"分享退休后的生活和晚年感悟",backgroundImage:"/src/images/story9.png",completed:!1},{id:"wisdom",title:"人生感悟",description:"分享人生智慧和生活哲理",backgroundImage:"/src/images/story10.png",completed:!1}]}),computed:{completedCount(){return this.chapters.filter(e=>e.completed).length},totalChapters(){return this.chapters.length}},onLoad(){this.loadChapterStatus(),this.preloadChapterImages(),this.loadUserChapters()},onShow(){this.loadUserChapters()},methods:{getOptimalImagePath:y,preloadChapterImages(){const e=this.chapters.map(e=>e.backgroundImage);C.preloadChapterImages(e).then(()=>{console.log("章节图片预加载完成")}).catch(e=>{console.warn("章节图片预加载失败:",e)})},goBack(){l()},selectChapter(e){e.isDiary?o({url:`/pages/diary/edit?chapterId=${e.id}&title=${encodeURIComponent(e.title)}&mode=edit`}):o({url:`/pages/recording/index?chapterId=${e.id}&title=${encodeURIComponent(e.title)}`})},getChapterNumber:e=>["一","二","三","四","五","六","七","八","九","十"][e]||e+1,loadChapterStatus(){try{const e=s("user"),t=null==e?void 0:e.id;if(!t)return void this.chapters.forEach(e=>{e.completed=!1});const a=s(`chapter_status_${t}`);if(a){const e=JSON.parse(a);this.chapters.forEach(t=>{e[t.id]&&(t.completed=e[t.id].completed||!1)})}}catch(e){console.log("加载章节状态失败:",e)}},async loadUserChapters(){try{console.log("🔄 开始加载用户章节...");const e=s("token");if(!e)return void console.log("❌ 未登录，跳过加载用户章节");const t=await c({url:k("/chapters"),method:"GET",header:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(console.log("📊 用户章节响应:",t),200===t.statusCode&&t.data.success){const e=(t.data.data||{}).chapters||[];console.log("📚 获取到用户章节:",e);const a=e.filter(e=>e.chapterId&&!e.chapterId.startsWith("diary_"));console.log("📖 过滤出的固定章节:",a),a.forEach(e=>{const t=this.chapters.find(t=>t.id===e.chapterId);t&&(t.completed="completed"===e.status)}),console.log("✅ 用户章节状态更新完成")}else console.log("❌ 获取用户章节失败:",t.data)}catch(e){console.error("❌ 加载用户章节出错:",e)}}}},[["render",function(e,s,c,o,l,k){const C=n,y=r,v=b,j=g;return d(),t(y,{class:"container"},{default:a(()=>[i(y,{class:"nav-header"},{default:a(()=>[i(y,{class:"back-btn",onClick:k.goBack},{default:a(()=>[i(C,{class:"back-icon"},{default:a(()=>[p("←")]),_:1})]),_:1},8,["onClick"]),i(y,{class:"nav-title"},{default:a(()=>[p("人生章节")]),_:1})]),_:1}),i(y,{class:"content"},{default:a(()=>[i(y,{class:"stats-section"},{default:a(()=>[i(y,{class:"stats-card"},{default:a(()=>[i(y,{class:"stat-item"},{default:a(()=>[i(C,{class:"stat-number"},{default:a(()=>[p(m(k.completedCount),1)]),_:1}),i(C,{class:"stat-label"},{default:a(()=>[p("已完成")]),_:1})]),_:1}),i(y,{class:"stat-divider"}),i(y,{class:"stat-item"},{default:a(()=>[i(C,{class:"stat-number"},{default:a(()=>[p(m(k.totalChapters),1)]),_:1}),i(C,{class:"stat-label"},{default:a(()=>[p("总章节")]),_:1})]),_:1})]),_:1})]),_:1}),i(y,{class:"chapters-section"},{default:a(()=>[i(j,{class:"chapters-scroll","scroll-y":"true","show-scrollbar":"false","enable-flex":"true"},{default:a(()=>[i(y,{class:"chapters-container"},{default:a(()=>[(d(!0),h(u,null,f(l.chapters,(e,s)=>(d(),t(y,{key:e.id,class:_(["chapter-card",{completed:e.completed,first:0===s,last:s===l.chapters.length-1}]),onClick:t=>k.selectChapter(e)},{default:a(()=>[i(y,{class:"chapter-bg"},{default:a(()=>[i(v,{src:k.getOptimalImagePath(e.backgroundImage),class:"bg-image",mode:"aspectFill"},null,8,["src"]),i(y,{class:"bg-overlay"})]),_:2},1024),i(y,{class:"chapter-content"},{default:a(()=>[i(y,{class:"chapter-number"},{default:a(()=>[p("第"+m(k.getChapterNumber(s))+"章",1)]),_:2},1024),i(y,{class:"chapter-title"},{default:a(()=>[p(m(e.title),1)]),_:2},1024),i(y,{class:"chapter-desc"},{default:a(()=>[p(m(e.description),1)]),_:2},1024),e.completed?(d(),t(y,{key:0,class:"chapter-status"},{default:a(()=>[i(y,{class:"status-icon"},{default:a(()=>[p("✓")]),_:1})]),_:1})):I("",!0)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1}),i(y,{class:"tip-section"},{default:a(()=>[i(C,{class:"tip-text"},{default:a(()=>[p("上下滑动浏览章节，点击开始录制")]),_:1})]),_:1})]),_:1})]),_:1})}],["__scopeId","data-v-d0deb415"]]);export{j as default};
