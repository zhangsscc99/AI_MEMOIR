import{c as e,w as t,f as a,i as o,o as s,B as i,N as r,a as d,b as l,m as n,O as h}from"./index-DQU_JAH0.js";import{g}from"./imageMapping.mDgfjL7P.js";import{_ as m}from"./_plugin-vue_export-helper.BCo6x5W8.js";const c=m({name:"LazyImage",props:{src:{type:String,required:!0},width:{type:String,default:"100%"},height:{type:String,default:"200px"},mode:{type:String,default:"aspectFill"},placeholderColor:{type:String,default:"#f5f5f5"},imageClass:{type:String,default:""},enableWebP:{type:Boolean,default:!0},immediate:{type:Boolean,default:!1}},data:()=>({loaded:!1,loading:!1,error:!1}),computed:{optimizedSrc(){return this.src?this.src.startsWith("http")?this.src:g(this.src):""}},mounted(){this.immediate?this.preloadImage():this.loadImage()},methods:{loadImage(){if(this.src)if(this.loading=!0,"undefined"!=typeof IntersectionObserver){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(this.preloadImage(),e.unobserve(t.target))})});e.observe(this.$el)}else this.preloadImage()},preloadImage(){const e=new Image;e.onload=()=>{this.loaded=!0,this.loading=!1,this.$emit("load")},e.onerror=()=>{this.loading=!1,this.error=!0,this.$emit("error")},e.src=this.optimizedSrc},onImageLoad(){this.loaded=!0,this.loading=!1,this.$emit("load")},onImageError(){this.loading=!1,this.error=!0,this.$emit("error")}}},[["render",function(g,m,c,p,f,u){const y=o,I=l;return s(),e(y,{class:"lazy-image-container",style:a({width:c.width,height:c.height})},{default:t(()=>[f.loaded?i("",!0):(s(),e(y,{key:0,class:"image-placeholder",style:a({width:c.width,height:c.height,backgroundColor:c.placeholderColor})},{default:t(()=>[f.loading?(s(),e(y,{key:0,class:"loading-spinner"},{default:t(()=>[d(y,{class:"spinner"})]),_:1})):i("",!0)]),_:1},8,["style"])),r(d(I,{src:u.optimizedSrc,mode:c.mode,class:n(c.imageClass),style:a({width:c.width,height:c.height}),onLoad:u.onImageLoad,onError:u.onImageError,"lazy-load":!0},null,8,["src","mode","class","style","onLoad","onError"]),[[h,f.loaded]])]),_:1},8,["style"])}],["__scopeId","data-v-b4f37cdc"]]);export{c as default};
