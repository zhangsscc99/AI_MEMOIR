function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/components-LazyImage.DWWZVpe-.js","assets/index-DQU_JAH0.js","assets/index-DBRlL7wL.css","assets/imageMapping.mDgfjL7P.js","assets/_plugin-vue_export-helper.BCo6x5W8.js","assets/LazyImage-4nOqDq01.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{_ as e,c as t,w as a,s,n as o,g as l,r,i as c,o as i,a as d,b as n,d as p,e as g,f as m,h as u,j as h,S as f,k as _,F as C,l as y,m as b,t as I}from"./index-DQU_JAH0.js";import{a as k}from"./apiConfig.BpiTqs15.js";import{i as x}from"./imagePreloader.BIvFExa3.js";import{g as v}from"./imageMapping.mDgfjL7P.js";import{_ as w}from"./_plugin-vue_export-helper.BCo6x5W8.js";const P=w({components:{LazyImage:()=>e(()=>import("./components-LazyImage.DWWZVpe-.js"),__vite__mapDeps([0,1,2,3,4,5]))},data:()=>({progressPercent:0,totalChapters:10,completedChapters:[],allChapters:[{id:"background",title:"家庭背景",description:"记录您的出生地、家庭环境和祖辈故事",backgroundImage:"/src/images/story1.png",completed:!1},{id:"childhood",title:"童年时光",description:"分享童年的美好回忆和成长经历",backgroundImage:"/src/images/story2.png",completed:!1},{id:"education",title:"求学生涯",description:"记录学习历程和校园生活",backgroundImage:"/src/images/story3.png",completed:!1},{id:"career",title:"职业发展",description:"分享工作经历和职业成就",backgroundImage:"/src/images/story4.png",completed:!1},{id:"love",title:"爱情婚姻",description:"记录爱情故事和婚姻生活",backgroundImage:"/src/images/story5.png",completed:!1},{id:"family",title:"为人父母",description:"分享育儿经历和家庭生活",backgroundImage:"/src/images/story6.png",completed:!1},{id:"travel",title:"旅行见闻",description:"记录旅行经历和见闻感悟",backgroundImage:"/src/images/story7.png",completed:!1},{id:"relationships",title:"人缘际遇",description:"记录重要的人际关系和人生际遇",backgroundImage:"/src/images/story8.png",completed:!1},{id:"laterlife",title:"晚年生活",description:"分享退休后的生活和晚年感悟",backgroundImage:"/src/images/story9.png",completed:!1},{id:"wisdom",title:"人生感悟",description:"分享人生智慧和生活哲理",backgroundImage:"/src/images/story10.png",completed:!1}]}),onLoad(){this.loadChapterData(),this.loadUserChapters(),this.preloadCriticalImages()},onShow(){this.loadChapterData(),this.loadUserChapters()},methods:{getOptimalImagePath:v,preloadCriticalImages(){x.preloadCritical(["/src/images/memoirbook.png","/src/images/winter.png","/src/images/lion.png"]).then(()=>{console.log("关键图片预加载完成")}).catch(e=>{console.warn("关键图片预加载失败:",e)})},loadChapterData(){try{const e=l("user"),t=null==e?void 0:e.id;if(!t)return this.allChapters.forEach(e=>{e.completed=!1}),void(this.progressPercent=0);const a=l(`chapter_status_${t}`);if(a){const e=JSON.parse(a);let t=0;this.allChapters.forEach(a=>{e[a.id]&&e[a.id].completed?(a.completed=!0,t++):a.completed=!1}),this.progressPercent=t/this.totalChapters*100}else this.allChapters.forEach(e=>{e.completed=!1}),this.progressPercent=0}catch(e){console.log("加载章节数据失败:",e),this.allChapters.forEach(e=>{e.completed=!1}),this.progressPercent=0}},async loadUserChapters(){try{const e=l("token");if(!e)return void console.log("用户未登录，跳过加载用户章节");const t=await r({url:k("/chapters"),method:"GET",header:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(200===t.statusCode&&t.data.success){const e=(t.data.data||{}).chapters||[];console.log("📚 获取到用户章节:",e);const a=e.filter(e=>e.chapterId&&!e.chapterId.startsWith("diary_"));console.log("📖 过滤出的固定章节:",a),a.forEach(e=>{const t=this.allChapters.find(t=>t.id===e.chapterId);t&&(t.completed="completed"===e.status)}),console.log("✅ 用户章节状态更新完成")}else console.log("❌ 获取用户章节失败:",t.data)}catch(e){console.error("❌ 加载用户章节出错:",e)}},getChapterNumber:e=>["一","二","三","四","五","六","七","八","九","十"][e]||e+1,goToChapter(e){e.isDiary?o({url:`/pages/diary/edit?chapterId=${e.id}&title=${encodeURIComponent(e.title)}&mode=view`}):o({url:`/pages/recording/index?chapterId=${e.id}&title=${encodeURIComponent(e.title)}`})},getPreviewText:e=>e?e.length>50?e.substring(0,50)+"...":e:"暂无内容",viewChapter(e){o({url:`/pages/recording/index?chapterId=${e.id}&title=${encodeURIComponent(e.title)}`})},goToMemoir(){s({url:"/pages/memoir/index"})},goToDiary(){console.log("点击随记卡片，准备跳转到随记页面"),s({url:"/pages/diary/index",success:function(){console.log("成功跳转到随记页面")},fail:function(e){console.error("跳转到随记页面失败:",e),o({url:"/pages/diary/index"})}})},goToChapters(){console.log("点击开始录制按钮，准备跳转到岁月镜像"),s({url:"/pages/memoir/index"})}}},[["render",function(e,s,o,l,r,k){const x=n,v=c,w=g,P=u,T=f;return i(),t(v,{class:"container"},{default:a(()=>[d(v,{class:"memoir-card",onClick:k.goToMemoir},{default:a(()=>[d(v,{class:"memoir-card-left"},{default:a(()=>[d(x,{src:k.getOptimalImagePath("/src/images/memoirbook.png"),class:"book-cover",mode:"aspectFit"},null,8,["src"])]),_:1}),d(v,{class:"memoir-card-right"},{default:a(()=>[d(v,{class:"memoir-content"},{default:a(()=>[d(v,{class:"memoir-title"},{default:a(()=>[p("回忆录")]),_:1}),d(v,{class:"memoir-subtitle"},{default:a(()=>[p("记录您的人生故事")]),_:1}),d(v,{class:"memoir-progress"},{default:a(()=>[d(w,{class:"progress-text"},{default:a(()=>[p("0/36")]),_:1}),d(w,{class:"progress-label"},{default:a(()=>[p("已录制")]),_:1})]),_:1}),d(v,{class:"progress-bar"},{default:a(()=>[d(v,{class:"progress-fill",style:m({width:r.progressPercent+"%"})},null,8,["style"])]),_:1})]),_:1}),d(P,{class:"start-btn",onClick:k.goToChapters},{default:a(()=>[p("开始录制")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["onClick"]),d(v,{class:"diary-card",onClick:k.goToDiary},{default:a(()=>[d(x,{src:k.getOptimalImagePath("/src/images/winter.png"),class:"diary-bg",mode:"aspectFill"},null,8,["src"]),d(v,{class:"diary-overlay"},{default:a(()=>[d(v,{class:"diary-title"},{default:a(()=>[p("随记")]),_:1}),d(v,{class:"diary-subtitle"},{default:a(()=>[p("记录照片里的故事，随手写下生活点滴"),h("br"),p("轻松导入回忆录")]),_:1})]),_:1})]),_:1},8,["onClick"]),d(v,{class:"section-preview"},{default:a(()=>[d(v,{class:"section-title"},{default:a(()=>[p("章节预览")]),_:1}),d(T,{class:"chapters-scroll","scroll-x":"true","show-scrollbar":"false","enable-flex":"true"},{default:a(()=>[d(v,{class:"chapters-container"},{default:a(()=>[(i(!0),_(C,null,y(r.allChapters,(e,s)=>(i(),t(v,{key:e.id,class:b(["chapter-preview-card",{completed:e.completed,first:0===s,last:s===r.allChapters.length-1}]),onClick:t=>k.goToChapter(e)},{default:a(()=>[d(v,{class:"card-bg"},{default:a(()=>[d(x,{src:k.getOptimalImagePath(e.backgroundImage),class:"bg-image",mode:"aspectFill"},null,8,["src"]),d(v,{class:"bg-overlay"})]),_:2},1024),d(v,{class:"card-content"},{default:a(()=>[d(v,{class:"chapter-number"},{default:a(()=>[p("第"+I(k.getChapterNumber(s))+"章",1)]),_:2},1024),d(v,{class:"chapter-title"},{default:a(()=>[p(I(e.title),1)]),_:2},1024),d(v,{class:"chapter-subtitle"},{default:a(()=>[p(I(e.description),1)]),_:2},1024),e.completed?(i(),t(v,{key:0,class:"completion-status"},{default:a(()=>[d(v,{class:"status-icon"},{default:a(()=>[p("✓")]),_:1}),d(w,{class:"status-text"},{default:a(()=>[p("已完成")]),_:1})]),_:1})):(i(),t(v,{key:1,class:"completion-status not-started"},{default:a(()=>[d(v,{class:"status-icon"},{default:a(()=>[p("◯")]),_:1}),d(w,{class:"status-text"},{default:a(()=>[p("未开始")]),_:1})]),_:1}))]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1}),d(v,{class:"scroll-tip"},{default:a(()=>[d(w,{class:"tip-text"},{default:a(()=>[p("左右滑动浏览章节")]),_:1})]),_:1})]),_:1})]),_:1})}],["__scopeId","data-v-8aaa2b10"]]);export{P as default};
